<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Vending Machine | Ryan H.Y. Zhang </title> <meta name="author" content="Ryan H.Y. Zhang"> <meta name="description" content="A 12-bit Finite State Machine Built from Scratch in Logisim"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://rhyzhang.github.io/projects/Vending_Machine/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Ryan</span> H.Y. Zhang </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/resume.pdf">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/gratitude/">gratitude </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Vending Machine</h1> <p class="post-description">A 12-bit Finite State Machine Built from Scratch in Logisim</p> </header> <article> <h2 id="project-overview">Project Overview</h2> <p><strong>GitHub Repository:</strong> <a href="https://github.com/ELROSTEM/computational-thinking/tree/main/Unit1-LogicGates/RyanZhang2024/Boba_Vending_Machine" rel="external nofollow noopener" target="_blank">ELROSTEM/computational-thinking - Boba Vending Machine</a></p> <p>I completed this project for my Computational Thinking class to conclude our unit on Digital Systems Architecture. It serves as the culmination of everything we built from scratch, ranging from basic XOR gates and flip-flops to more complex components like adders, ripple counters, synchronous counters, and 4-bit multipliers.</p> <p>The system simulates the complete user experience from accepting multi-denomination currency, maintaining a credit balance, decoding user product selection, dispensing products, and calculating/dispensing precise change. The core challenge was orchestrating asynchronous user inputs into a synchronous, clock-driven system while managing a custom 12-bit datapath for financial calculations.</p> <h2 id="high-level-architecture">High-Level Architecture</h2> <p>The system is designed around a modular architecture. Instead of a monolithic circuit, the machine is broken down into distinct functional blocks (Input, Processing, Output, and Display) connected by a central 12-bit data bus.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/vending_machine_main-480.webp 480w,/assets/img/vending_machine_main-800.webp 800w,/assets/img/vending_machine_main-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/vending_machine_main.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><strong>System Specifications:</strong></p> <ul> <li> <strong>Bus Width:</strong> 12-bit (supporting values up to 4096, sufficient for currency operations in cents).</li> <li> <strong>Clock:</strong> Global system clock for register synchronization.</li> <li> <strong>Display:</strong> Multiplexed 7-segment displays driven by a custom Binary-to-BCD converter.</li> <li> <strong>Products:</strong> 3 selectable flavors (Milk Tea, Brown Sugar, Mocha) with distinct pricing.</li> </ul> <h2 id="subsystem-deep-dive">Subsystem Deep-Dive</h2> <h3 id="1-money-processing-accumulator--arithmetic">1. Money Processing (Accumulator &amp; Arithmetic)</h3> <p>The heart of the machine is the money handling logic. I implemented a cumulative adder that takes single pulse inputs from coin slots (1¢ to $20) and adds them to a running 12-bit register.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/vending_machine_money_input-480.webp 480w,/assets/img/vending_machine_money_input-800.webp 800w,/assets/img/vending_machine_money_input-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/vending_machine_money_input.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>This module acts as a specialized CPU datapath:</p> <ul> <li> <strong>Input Stage:</strong> AND-gate arrays validate the specific coin inputs.</li> <li> <strong>Accumulation:</strong> A Super Adder creates a feedback loop with a register to hold the current balance.</li> <li> <strong>Reset Logic:</strong> A synchronous clear signal resets the balance to zero once a transaction is finalized.</li> </ul> <h3 id="2-signal-decoding--state-management">2. Signal Decoding &amp; State Management</h3> <p>The machine relies on a rigid Finite State Machine to handle user inputs. The “Flavor Input” module uses a decoder to translate a 3-bit binary selection code into specific “enable” lines for the product registers.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/vending_machine_flavor_input_and_state-480.webp 480w,/assets/img/vending_machine_flavor_input_and_state-800.webp 800w,/assets/img/vending_machine_flavor_input_and_state-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/vending_machine_flavor_input_and_state.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>This ensures the system cannot attempt to dispense two products simultaneously.</p> <h3 id="3-human-readable-output-12-bit-binary-to-bcd">3. Human-Readable Output (12-bit Binary to BCD)</h3> <p>One of the most complex combinatorial challenges was converting the 12-bit binary internal balance into a human-readable decimal format for the digital displays.</p> <p>Since a standard hex display would be user-unfriendly, I engineered a 12-bit to Binary Coded Decimal (BCD) converter. This module uses a cascaded series of Add-3 (Double Dabble) algorithms to shift binary values into Ones, Tens, Hundreds, and Thousands columns.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/12_bit_BCD_Converter-480.webp 480w,/assets/img/12_bit_BCD_Converter-800.webp 800w,/assets/img/12_bit_BCD_Converter-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/12_bit_BCD_Converter.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h3 id="4-transaction-finalization--dispensing">4. Transaction Finalization &amp; Dispensing</h3> <p>When the “Buy” signal is asserted, the system performs a parallel check:</p> <ol> <li> <strong>Comparison:</strong> Is Balance &gt;= Price?</li> <li> <strong>Arithmetic:</strong> Calculate <code class="language-plaintext highlighter-rouge">Balance - Price</code> to determine change.</li> <li> <strong>Actuation:</strong> If valid, trigger the product motor simulation and the change dispenser.</li> </ol> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/vending_machine_coin_dispense-480.webp 480w,/assets/img/vending_machine_coin_dispense-800.webp 800w,/assets/img/vending_machine_coin_dispense-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/vending_machine_coin_dispense.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/vending_machine_product_dispense-480.webp 480w,/assets/img/vending_machine_product_dispense-800.webp 800w,/assets/img/vending_machine_product_dispense-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/vending_machine_product_dispense.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>The <code class="language-plaintext highlighter-rouge">vending_machine_product_dispense</code> module utilizes shift registers to simulate the time-delay of a motor turning, ensuring the “Product Dropped” signal is only sent after a specific number of clock cycles.</p> <h2 id="technical-challenges--takeaways">Technical Challenges &amp; Takeaways</h2> <ul> <li> <strong>Synchronous vs. Asynchronous domains:</strong> The user pushes buttons asynchronously (randomly), but the internal logic is synchronous. I had to implement registers to “latch” these inputs to ensure the adder didn’t miss coins or double-count due to switch bounce.</li> <li> <strong>Datapath Width Constraints:</strong> Managing a 12-bit bus required careful routing. Every logic gate interacting with the balance (Comparators, Adders, MUXs) had to be bit-width compatible.</li> </ul> <p>This project demonstrated that complex systems like vending machines are just is layers upon layers of composition of basic logic gates. Computers are so cool!</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Ryan H.Y. Zhang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-2LBFQJW6RB"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2LBFQJW6RB");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>